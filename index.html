<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>⚠️ ALERTA DE SISTEMA ⚠️</title>
    <style>
        body {
            margin: 0; padding: 0; background-color: black;
            overflow: hidden; font-family: 'Courier New', Courier, monospace;
            touch-action: none; /* Evita que la pantalla haga scroll al deslizar el dedo */
        }

        canvas {
            display: block; position: absolute; top: 0; left: 0; z-index: 1;
        }

        /* --- PANTALLA TRAMPA --- */
        #pantalla-inicio {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: black; z-index: 500;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: #0f0; cursor: pointer; transition: opacity 0.5s;
        }
        #pantalla-inicio h1 { font-size: 1.5rem; border: 1px solid #0f0; padding: 15px; background: rgba(0,255,0,0.1); text-align: center;}
        #pantalla-inicio p { font-size: 0.9rem; opacity: 0.7; }

        /* --- TERMINAL HACKER --- */
        #terminal {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); z-index: 10;
            width: 90%; max-width: 650px;
            color: #0f0;
            font-size: 1.3rem; 
            text-shadow: 0 0 5px #0f0;
            pointer-events: none; transition: opacity 0.5s;
        }

        .line {
            margin: 10px 0; min-height: 1.6rem; opacity: 0; line-height: 1.4;
        }

        #progress-bar { color: #0f0; font-weight: bold; letter-spacing: 2px; }

        #line-alert {
            color: #ff3333; text-shadow: 0 0 10px #ff3333;
            font-weight: bold; margin-top: 15px; font-size: 1.4rem;
        }

        #line-action {
            color: #ffcc00; text-shadow: 0 0 8px #ffcc00;
            font-weight: bold; margin-top: 20px;
            background: rgba(255, 204, 0, 0.1); padding: 10px; border: 1px solid #ffcc00;
        }

        .cursor { display: inline-block; animation: blink 1s step-end infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        /* --- MENSAJE IRROMPIBLE --- */
        #mensaje-irrompible {
            position: absolute; bottom: 10%; left: 50%;
            transform: translateX(-50%); z-index: 20;
            width: 90%; text-align: center;
            color: #0f0; font-size: 1.1rem; text-shadow: 0 0 8px #0f0;
            opacity: 0; pointer-events: none; transition: opacity 2s ease-in-out;
        }
        #mensaje-irrompible .destaque {
            color: #ff3333; font-weight: bold; font-size: 1.4rem;
            text-shadow: 0 0 15px #ff3333; display: block; margin-top: 10px;
        }

        @media (max-width: 600px) {
            #terminal { font-size: 1.05rem; } 
            #line-alert { font-size: 1.15rem; }
            #mensaje-irrompible { font-size: 0.9rem; }
            #mensaje-irrompible .destaque { font-size: 1.2rem; }
        }
    </style>
</head>
<body>

    <audio id="audio-musica" preload="auto"><source src="musica.mp3" type="audio/mpeg"></audio>

    <div id="pantalla-inicio" onclick="iniciarAtaque()">
        <h1>> INICIAR DIAGNOSTICO DEL SISTEMA</h1>
        <p>(Toca la pantalla para comenzar)</p>
    </div>

    <canvas id="matrix"></canvas>

    <div id="terminal">
        <div id="line1" class="line"></div>
        <div id="line2" class="line"></div>
        <div id="line3" class="line"></div>
        <div id="progress-bar" class="line"></div>
        <div id="line-alert" class="line"></div>
        <div id="line-action" class="line"></div>
    </div>

    <div id="mensaje-irrompible">
        > Intenta romper las letras deslizando el dedo...
        <span class="destaque">¡NUESTRO VÍNCULO ES IRROMPIBLE!</span>
    </div>

    <script>
        // --- MOTOR DE AUDIO SINTÉTICO ---
        let audioCtx;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        function playKeystroke() {
            if (!audioCtx) return;
            const time = audioCtx.currentTime;
            
            const bufferSize = audioCtx.sampleRate * 0.05; 
            const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferSize; i++) {
                data[i] = Math.random() * 2 - 1;
            }
            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer;
            
            const filter = audioCtx.createBiquadFilter();
            filter.type = 'bandpass'; 
            filter.frequency.value = 2500 + Math.random() * 500; 
            
            const noiseGain = audioCtx.createGain();
            noiseGain.gain.setValueAtTime(0.8, time);
            noiseGain.gain.exponentialRampToValueAtTime(0.01, time + 0.02);
            
            noise.connect(filter);
            filter.connect(noiseGain);
            noiseGain.connect(audioCtx.destination);
            noise.start(time);
            
            const osc = audioCtx.createOscillator();
            const oscGain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(300, time);
            osc.frequency.exponentialRampToValueAtTime(50, time + 0.03);
            
            oscGain.gain.setValueAtTime(0.3, time);
            oscGain.gain.exponentialRampToValueAtTime(0.01, time + 0.03);
            
            osc.connect(oscGain);
            oscGain.connect(audioCtx.destination);
            osc.start(time);
            osc.stop(time + 0.04);
        }

        // --- MATRIX ENGINE & INTERACCIÓN ---
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d', { willReadFrequently: true });
        const musicaRomantica = document.getElementById('audio-musica');

        let width = canvas.width = window.innerWidth;
        let height = canvas.height = window.innerHeight;

        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()ｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝ';
        const fontSize = 16;
        let columns = canvas.width / fontSize; 

        let drops = [];
        for (let x = 0; x < columns; x++) { drops[x] = 1; }
        let matrixSpeed = 50; 
        let matrixInterval;

        let particles = [];
        let isFormingText = false;
        let esperandoInteraccion = false;

        // Variables para el dedo/mouse
        let puntero = { x: -1000, y: -1000, activo: false };

        // Escuchadores de interacción para romper las letras
        window.addEventListener('mousemove', (e) => {
            puntero.x = e.clientX; puntero.y = e.clientY; puntero.activo = true;
        });
        window.addEventListener('touchmove', (e) => {
            puntero.x = e.touches[0].clientX; puntero.y = e.touches[0].clientY; puntero.activo = true;
        });
        window.addEventListener('mouseout', () => puntero.activo = false);
        window.addEventListener('touchend', () => puntero.activo = false);

        function prepararTexto() {
            const tempCanvas = document.createElement('canvas');
            const tempCtx = tempCanvas.getContext('2d');
            tempCanvas.width = width; tempCanvas.height = height;

            let fontSizeText = width < 600 ? width / 5 : width / 8;
            tempCtx.font = `bold ${fontSizeText}px "Courier New", monospace`;
            tempCtx.fillStyle = 'white'; tempCtx.textAlign = 'center'; tempCtx.textBaseline = 'middle';

            tempCtx.fillText('TE AMO', width / 2, height / 2 - fontSizeText / 1.5);
            tempCtx.fillText('DIOCE ❤️', width / 2, height / 2 + fontSizeText / 1.5);

            const imgData = tempCtx.getImageData(0, 0, width, height).data;
            const step = width < 600 ? 5 : 8; 
            particles = [];

            for (let y = 0; y < height; y += step) {
                for (let x = 0; x < width; x += step) {
                    if (imgData[(y * width + x) * 4 + 3] > 128) {
                        particles.push({
                            x: Math.random() * width, y: Math.random() * height - height, 
                            targetX: x, targetY: y, speed: Math.random() * 3 + 2, 
                            char: chars.charAt(Math.floor(Math.random() * chars.length)), color: '#0F0'
                        });
                    }
                }
            }
        }

        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0F0'; ctx.font = fontSize + 'px monospace'; ctx.textAlign = 'left';

            for (let i = 0; i < drops.length; i++) {
                const text = chars.charAt(Math.floor(Math.random() * chars.length));
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            }

            if (isFormingText) {
                ctx.font = (width < 600 ? '10px' : '14px') + ' monospace'; ctx.textAlign = 'center';
                particles.forEach(p => {
                    if (Math.random() < 0.05) p.char = chars.charAt(Math.floor(Math.random() * chars.length));
                    
                    // --- FÍSICA DE REPULSIÓN (ROMPER LETRAS) ---
                    if (puntero.activo) {
                        let dxPuntero = p.x - puntero.x;
                        let dyPuntero = p.y - puntero.y;
                        let distancia = Math.sqrt(dxPuntero * dxPuntero + dyPuntero * dyPuntero);
                        let radioRepulsion = width < 600 ? 60 : 100; // Área de efecto

                        if (distancia < radioRepulsion) {
                            let fuerza = (radioRepulsion - distancia) / radioRepulsion;
                            p.x += (dxPuntero / distancia) * fuerza * 40; // Qué tan fuerte salen volando
                            p.y += (dyPuntero / distancia) * fuerza * 40;
                        }
                    }

                    // --- FÍSICA DE ATRACCIÓN (REARMAR LETRAS) ---
                    let dx = p.targetX - p.x; let dy = p.targetY - p.y;
                    p.x += dx * 0.08; // Qué tan rápido regresan a su lugar original
                    p.y += dy * 0.08;

                    if (Math.abs(dx) < 1 && Math.abs(dy) < 1) p.color = Math.random() > 0.95 ? '#fff' : '#0f0';
                    ctx.fillStyle = p.color; ctx.shadowBlur = 5; ctx.shadowColor = '#0f0';
                    ctx.fillText(p.char, p.x, p.y); ctx.shadowBlur = 0;
                });
            }
        }

        window.addEventListener('resize', () => {
            width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight;
            columns = canvas.width / fontSize; prepararTexto();
        });
        prepararTexto();

        // --- SISTEMA DE ESCRITURA ---
        function typeWriter(elementId, text, speed, callback) {
            const el = document.getElementById(elementId);
            el.style.opacity = 1; let i = 0;
            
            function type() {
                if (i < text.length) {
                    el.innerHTML += text.charAt(i); 
                    
                    if (text.charAt(i) !== ' ') {
                        playKeystroke();
                    }
                    
                    i++;
                    if(navigator.vibrate && i % 4 === 0) navigator.vibrate(10); 
                    setTimeout(type, speed);
                } else {
                    if (callback) setTimeout(callback, 500); 
                }
            }
            type();
        }

        function simulateProgress(elementId, duration, callback) {
            const el = document.getElementById(elementId);
            el.style.opacity = 1; let progress = 0; const totalBlocks = 20; 

            const interval = setInterval(() => {
                progress += Math.floor(Math.random() * 8) + 1; 
                if (progress > 100) progress = 100;
                
                playKeystroke();
                if(navigator.vibrate) navigator.vibrate([20, 30, 20]);

                let filled = Math.floor((progress / 100) * totalBlocks);
                let empty = totalBlocks - filled;
                let bar = '[' + '█'.repeat(filled) + '░'.repeat(empty) + '] ' + progress + '%';
                el.innerHTML = '> Inyectando Payload_Malicioso.exe... <br>' + bar;

                if (progress === 100) {
                    clearInterval(interval);
                    setTimeout(callback, 800); 
                }
            }, duration / 20);
        }

        // --- INICIO DEL HACKEO ---
        function iniciarAtaque() {
            initAudio(); 

            document.getElementById('pantalla-inicio').style.opacity = 0;
            setTimeout(() => { document.getElementById('pantalla-inicio').style.display = 'none'; }, 500);

            matrixInterval = setInterval(drawMatrix, matrixSpeed);

            setTimeout(() => {
                typeWriter('line1', '> Estableciendo conexion remota con dispositivo objetivo... [EXITO]', 60, () => {
                    typeWriter('line2', '> Evadiendo protocolos de seguridad y firewall... [BYPASS COMPLETADO]', 50, () => {
                        typeWriter('line3', '> Extrayendo informacion privada, fotos y contraseñas...', 60, () => {
                            
                            ctx.fillStyle = 'rgba(0, 0, 0, 0.6)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
                            
                            simulateProgress('progress-bar', 4000, () => {
                                
                                if(navigator.vibrate) navigator.vibrate([400, 200, 400]); 

                                typeWriter('line-alert', '> ¡ADVERTENCIA CRITICA! Virus troyano instalado. Control total del dispositivo adquirido.', 50, () => {
                                    typeWriter('line-action', '> TOCA LA PANTALLA INMEDIATAMENTE PARA ABORTAR INFECCION Y RESTAURAR EL SISTEMA', 45, () => {
                                        document.getElementById('line-action').innerHTML += '<span class="cursor">_</span>';
                                        esperandoInteraccion = true;
                                    });
                                });
                            });
                        });
                    });
                });
            }, 1000); 
        }

        // --- EL TOQUE MÁGICO FINAL ---
        function desbloquearSistema() {
            if (!esperandoInteraccion) return; 
            esperandoInteraccion = false;

            musicaRomantica.play().catch(e=>console.log(e));
            
            if(navigator.vibrate) navigator.vibrate([100, 50, 100, 500, 100, 50, 100]);

            document.getElementById('terminal').style.opacity = 0;
            isFormingText = true;
            
            clearInterval(matrixInterval);
            matrixInterval = setInterval(drawMatrix, 20); 
            
            setTimeout(() => {
                clearInterval(matrixInterval);
                matrixInterval = setInterval(drawMatrix, 60); 
                
                // Mostrar el mensaje "Irrompible" después de que se forma el texto
                setTimeout(() => {
                    document.getElementById('mensaje-irrompible').style.opacity = 1;
                }, 1500);

            }, 1000);
        }

        window.addEventListener('click', (e) => {
            if(e.target.id !== 'pantalla-inicio') desbloquearSistema();
        });
        window.addEventListener('touchstart', (e) => {
            if(e.target.id !== 'pantalla-inicio') desbloquearSistema();
        });

    </script>
</body>
</html>